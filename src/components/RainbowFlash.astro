<span
  class="rainbow-flash inline-block"
  style="transition: background-color 0.3s linear, color 0.3s linear;"
>
  <slot />
</span>

<script type="text/javascript" client:load>
(() => {
  console.log('RainbowFlash script loaded');

  const el = document.querySelector('.rainbow-flash');
  console.log('Box found?', el);

  if (!el) return;

  function flashElement() {
    console.log('flashElement called on', el);

    const colors = ['#FF0000','#FF7F00','#FFFF00','#00FF00','#0000FF','#4B0082','#8B00FF'];
    const steps = colors.length * 5;
    const duration = 5000 / steps;
    let i = 0;

    const interval = setInterval(() => {
      el.style.backgroundColor = colors[i % colors.length];
      el.style.color = i % 2 === 0 ? '#FFFFFF' : '#000000';
      i++;
      if (i > steps) {
        clearInterval(interval);
        el.style.backgroundColor = '';
        el.style.color = '';
        console.log('Rainbow flash ended');
      }
    }, duration);
  }

  // Internal click triggers flash
  el.addEventListener('click', () => {
    console.log('Internal span clicked');
    flashElement();
  });
})();
</script>
